<form>
    <mat-form-field>
        <input matInput [matDatepicker]="dp" placeholder="Month and Year" [(ngModel)]="dateReference" [ngModelOptions]="{standalone: true}">
        <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
        <mat-datepicker #dp startView="multi-year" (yearSelected)="choosenYear($event, dp)"></mat-datepicker>
    </mat-form-field>
</form>

<form [formGroup]="form">
    <!-- Criação do formArray -->
    <mat-table [dataSource]="rows" class="mat-elevation-z8" formArrayName="data">
      <!-- Definição das colunas -->
      <ng-container matColumnDef="ticket">
        <mat-header-cell *matHeaderCellDef> Código </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{element.get('ticket').value}} </mat-cell>
        <mat-footer-cell *matFooterCellDef>Total</mat-footer-cell>
      </ng-container>
    
      <ng-container matColumnDef="description">
        <mat-header-cell *matHeaderCellDef> Ativo </mat-header-cell>
        <mat-cell *matCellDef="let element" class="cell"> {{element.get('description').value}} </mat-cell>
        <mat-footer-cell *matFooterCellDef/>
      </ng-container>

      @for(month of months; track $index) {
          <ng-container [matColumnDef]="vlMonths[$index]">
            <mat-header-cell *matHeaderCellDef class="vlMonth"> {{month}} </mat-header-cell>
            <mat-cell *matCellDef="let element" [formGroup]="element.get(vlMonths[$index])" class="number cell vlMonth">
                <input formControlName="amount" type="number" placeholder="0.00" step="0.01" class="w-100">
            </mat-cell>
            <mat-footer-cell *matFooterCellDef class="number vlMonth"> 
                <input type="number" placeholder="0.00" step="0.01" class="w-100 number-footer" readonly [value]="totalMonth(vlMonths[$index])">
            </mat-footer-cell>
          </ng-container>
      }
    
      <!-- Cabeçalho e linhas -->
      <mat-header-row *matHeaderRowDef="displayedColumns"/>
      <mat-row *matRowDef="let row; columns: displayedColumns;"/>
      <mat-footer-row *matFooterRowDef="displayedColumns" class="table-total"/>
    </mat-table>
</form>

<code>
    <pre>{{data.value | json}}</pre>
</code>